summary: A command-line tool to list open files
web-url: https://people.freebsd.org/~abe
git-url: https://github.com/lsof-org/lsof
src-url: https://github.com/lsof-org/lsof/archive/4.98.0.tar.gz
src-sha: 80308a614508814ac70eb2ae1ed2c4344dcf6076fa60afc7734d6b1a79e62b16
license: Zlib
dep-pkg: libtirpc libgetdtablesize
bsystem: gmake
binbstd: 1

api-min: 26

install: |
    if [ -f "$libtirpc_LIBRARY_DIR/libtirpc.a" ] ; then
        LIBTIRPC="$libtirpc_LIBRARY_DIR/libtirpc.a"
    else
        LIBTIRPC="$libtirpc_LIBRARY_DIR/libtirpc.so"
    fi

    export LSOF_MAKE="make"
    export LSOF_CC="$CC"
    export LSOF_AR="$AR rsc"
    export LSOF_RANLIB="$RANLIB"
    export LSOF_ARCH="$TARGET_PLATFORM_ARCH"
    export LSOF_INCLUDE="$SYSTEM_INCLUDE_DIR"
    export LSOF_CFGF="$CFLAGS $CPPFLAGS"
    export LSOF_CFGL="$LDFLAGS -L$PACKAGE_BSCRIPT_DIR/lib $LIBTIRPC"
    
    run ./Configure -clean &&
    run ./Configure -n linux &&
    gmakew &&
    run install_bins lsof &&
    run install_mans Lsof.8
