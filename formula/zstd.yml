summary: A real-time compression utility with high compression ratios
web-url: https://facebook.github.io/zstd
git-url: https://github.com/facebook/zstd
src-url: https://github.com/facebook/zstd/archive/v1.5.5.tar.gz
src-sha: 98e9c3d949d1b924e28e01eccb7deed865eefebf25c2f21c702e5cd5b63b85e1
license: BSD-3-Clause
dep-pkg: zlib liblzma
bscript: build/cmake

include: |
    // int   fseeko(FILE* __fp, off_t __offset, int __whence) __RENAME(fseeko64) __INTRODUCED_IN(24);
    // off_t ftello(FILE* __fp) __RENAME(ftello64) __INTRODUCED_IN(24);
    #if __ANDROID_API__ < 24
    #define ftello(f) ftell(f)
    #define fseeko    fseek
    #endif

install: |
    cmakew \
        -DZSTD_MULTITHREAD_SUPPORT=ON \
        -DZSTD_BUILD_TESTS=OFF \
        -DZSTD_BUILD_CONTRIB=OFF \
        -DZSTD_BUILD_PROGRAMS=ON \
        -DZSTD_BUILD_STATIC=ON \
        -DZSTD_BUILD_SHARED=OFF \
        -DZSTD_ZLIB_SUPPORT=ON \
        -DZSTD_LZMA_SUPPORT=ON \
        -DZSTD_LZ4_SUPPORT=OFF
    rm -rf "$PACKAGE_INSTALL_DIR/include"
    rm -rf "$PACKAGE_INSTALL_DIR/lib"
